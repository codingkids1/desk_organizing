import tkinter as tk
import random
from PIL import Image, ImageTk

class SlidingPuzzle:
    def __init__(self, root):
        self.root = root
        self.root.title("4x4 슬라이딩 퍼즐")
        self.tiles = list(range(1, 16)) + [None]
        random.shuffle(self.tiles)
        self.load_images()
        self.create_widgets()

    def load_images(self):
        original_image = Image.open("/Users/checkx/Downloads/KakaoTalk_Photo_2025-03-22-17-23-35.png")  # 사용할 이미지 파일
        self.tile_images = []
        img_size = original_image.size[0] // 4  # 4x4 퍼즐 조각 크기

        for i in range(4):
            for j in range(4):
                if i * 4 + j < 15:
                    cropped = original_image.crop((j * img_size, i * img_size, (j + 1) * img_size, (i + 1) * img_size))
                    self.tile_images.append(ImageTk.PhotoImage(cropped))
                else:
                    self.tile_images.append(None)

    def create_widgets(self):
        self.buttons = []
        for i in range(4):
            row = []
            for j in range(4):
                num = self.tiles[i * 4 + j]
                if num is not None:
                    btn = tk.Button(self.root, image=self.tile_images[num - 1], command=lambda i=i, j=j: self.move_tile(i, j))
                else:
                    btn = tk.Button(self.root, text="", width=80, height=80, state=tk.DISABLED)
                btn.grid(row=i, column=j)
                row.append(btn)
            self.buttons.append(row)

    def move_tile(self, row, col):
        empty_row, empty_col = self.find_empty()
        if abs(empty_row - row) + abs(empty_col - col) == 1:
            self.tiles[empty_row * 4 + empty_col], self.tiles[row * 4 + col] = self.tiles[row * 4 + col], self.tiles[empty_row * 4 + empty_col]
            self.update_buttons()

    def find_empty(self):
        index = self.tiles.index(None)
        return index // 4, index % 4

    def update_buttons(self):
        for i in range(4):
            for j in range(4):
                num = self.tiles[i * 4 + j]
                if num is not None:
                    self.buttons[i][j].config(image=self.tile_images[num - 1], state=tk.NORMAL)
                else:
                    self.buttons[i][j].config(text="", state=tk.DISABLED)

if __name__ == "__main__":
    root = tk.Tk()
    app = SlidingPuzzle(root)
    root.mainloop()
